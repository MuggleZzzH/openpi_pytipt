# Stage 11 Non-CFG Configuration
# ç¦ç”¨CFGåŠŸèƒ½çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•æ ‡å‡†è®­ç»ƒæ¨¡å¼

exp_name: stage11_no_cfg_test

# === åŸºæœ¬è·¯å¾„é…ç½® ===
policy_path: "/zhaohan/ZJH/openpi_pytorch/checkpoints/pi0_libero_pytorch"
output_dir: "./output/stage11_no_cfg"

# === ä»»åŠ¡é…ç½® ===
task:
  benchmark_name: "libero_goal"
  task_names_to_use:
    - "put_the_bowl_on_the_stove"
  num_parallel_envs: 4
  max_episode_length: null

# === ç®—æ³•é…ç½® ===
algo:
  demo_batch_size: 1
  rloo_batch_size: 4
  lr: 1e-5
  gradient_accumulation_steps: 8
  collection_cfg_scale: 1.0  # CFGç¦ç”¨æ—¶æ­¤å‚æ•°æ— æ•ˆï¼Œä½†ä¿ç•™å…¼å®¹æ€§
  cfg_uncond_weight: 0.1     # CFGç¦ç”¨æ—¶æ­¤å‚æ•°æ— æ•ˆï¼Œä½†ä¿ç•™å…¼å®¹æ€§
  rollout_skip_threshold: 3
  enable_rollout_stats_tracking: true
  rollout_stats_path: "./output/stage11_no_cfg/rollout_stats.json"
  use_val_init: false

# === ğŸ”¥ ç­–ç•¥é…ç½® - CFGç¦ç”¨ ===
policy:
  cfg_enabled: false  # ğŸš¨ ç¦ç”¨CFGåŠŸèƒ½
  train_expert_only: true
  freeze_vision_encoder: true

# === æ•°æ®å¤„ç†é…ç½® ===
dataset:
  num_init_states: 1
  state_dim: 8
  
  # æ•°æ®å¤„ç†æ–¹å¼é€‰æ‹©
  use_so100_processing: false  # å¯ä»¥é€‰æ‹©å¯ç”¨SO100å¤„ç†
  
  # Legacyçª—å£åŒ–é…ç½®
  windowing_mode: last
  window_stride: 10
  max_windows_per_episode: 1

# === è®­ç»ƒé…ç½® ===
training:
  num_train_steps: 10
  seed: 42
  save_freq: 5

# === æ—¥å¿—é…ç½® ===
logging:
  use_wandb: false
  log_freq: 1

# === ç‰¹æ€§å¼€å…³ ===
features:
  use_ript_vla_runner: false
  enable_parallel_envs: true
  enable_true_parallel_envs: true
  enable_smart_sampling: true
  use_parallel_init_state: false
  save_video: false
  enable_file_counter: true
  adaptive_cfg: false  # CFGç¦ç”¨æ—¶æ­¤åŠŸèƒ½è‡ªåŠ¨ç¦ç”¨
  early_stop_percentage: 0.8
  
  # åŠ¨æ€é‡‡æ ·é…ç½®
  dynamic_sampling:
    enabled: true
    p_min: 0.1
    p_max: 0.9

# === æ³¨æ„äº‹é¡¹ ===
# 1. CFGç¦ç”¨æ—¶ï¼Œä»¥ä¸‹åŠŸèƒ½å°†è‡ªåŠ¨è·³è¿‡ï¼š
#    - CFG embeddingå‚æ•°è®­ç»ƒ
#    - CFGå¼ºåº¦è¯„ä¼°
#    - CFGç›¸å…³çš„æŸå¤±è®¡ç®—åˆ†æ”¯
# 
# 2. è®­ç»ƒå°†ä½¿ç”¨æ ‡å‡†çš„ç­–ç•¥æ¢¯åº¦æ–¹æ³•
# 
# 3. å¯ä»¥ä¸SO100æ•°æ®å¤„ç†ç»“åˆä½¿ç”¨ï¼Œè·å¾—æ•°æ®åˆ©ç”¨ç‡æå‡
# 
# 4. é€‚ç”¨åœºæ™¯ï¼š
#    - å¯¹æ¯”CFGå’ŒéCFGæ¨¡å¼çš„æ€§èƒ½
#    - è°ƒè¯•è®­ç»ƒé—®é¢˜
#    - èµ„æºå—é™çš„ç¯å¢ƒ
