# ä¸¥æ ¼æŒ‰ç…§RIPT-VLAåŸç‰ˆé€»è¾‘çš„åˆ†å¸ƒå¼è®­ç»ƒé…ç½®
# åŸºäº /zhaohan/ZJH/ript-vla åŸç‰ˆå®ç°é€»è¾‘

exp_name: pi0_strict_ript_distributed

# --- è·¯å¾„é…ç½® ---
policy_path: "/zhaohan/ZJH/openpi_pytorch/checkpoints/pi0_libero_pytorch"
output_dir: "./pi0/ript/output/strict_ript_distributed"
norm_stats_path: "/zhaohan/ZJH/openpi_pytorch/lerobot_dataset/norm_stats.json"

# --- ä»»åŠ¡é…ç½® (ä¸¥æ ¼åŸç‰ˆé€»è¾‘) ---
task:
  # ğŸ”¥ åŸç‰ˆé€»è¾‘ï¼šä»»åŠ¡åˆ—è¡¨é€šè¿‡task_names_to_useæŒ‡å®š
  task_names_to_use:
    - "LIBERO_SPATIAL_pick_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_from_table_center_and_place_it_on_the_plate"  
    - "LIBERO_SPATIAL_pick_the_black_bowl_in_the_top_drawer_of_the_wooden_cabinet_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_next_to_the_cookie_box_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_next_to_the_plate_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_next_to_the_ramekin_and_place_it_on_the_plate" 
    - "LIBERO_SPATIAL_pick_the_black_bowl_on_the_cookie_box_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_on_the_ramekin_and_place_it_on_the_plate"
    - "LIBERO_SPATIAL_pick_the_black_bowl_on_the_stove_and_place_it_on_the_plate"
  
  # ğŸ”¥ æ¯ä¸ªä»»åŠ¡çš„å¹¶è¡Œç¯å¢ƒæ•°é‡
  num_parallel_envs: 1  # åŸç‰ˆï¼šå¤šä»»åŠ¡æ—¶ä½¿ç”¨1ä¸ªå¹¶è¡Œç¯å¢ƒ
  
  # æœ€å¤§episodeé•¿åº¦
  max_episode_length: 200

# --- ç®—æ³•é…ç½® (ä¸¥æ ¼åŸç‰ˆRIPT-VLAé€»è¾‘) ---
algo:
  # ğŸ”¥ RLOO (Leave-One-Out) æ‰¹æ¬¡å¤§å°
  rloo_batch_size: 2    # åŸç‰ˆé»˜è®¤å€¼
  
  # ğŸ”¥ æ•°æ®æ‰¹æ¬¡å¤§å° (ä»dataloaderè·å–çš„æ ·æœ¬æ•°)
  data_batch_size: 4    # æ¯æ¬¡ä»dataloaderè·å–çš„æ ·æœ¬æ•°
  
  # ğŸ”¥ åŸç‰ˆé€»è¾‘å‚æ•°
  enable_dynamic_sampling: false      # åŸç‰ˆæ²¡æœ‰åŠ¨æ€é‡‡æ ·
  enable_rollout_stats_tracking: true # åŸç‰ˆæœ‰ç»Ÿè®¡è·Ÿè¸ª
  rollout_skip_threshold: 3           # è·³è¿‡å…¨æˆåŠŸçŠ¶æ€çš„é˜ˆå€¼
  
  # PPOç›¸å…³å‚æ•° (è™½ç„¶æˆ‘ä»¬ç”¨ç®€åŒ–ç‰ˆCFG)
  ppo_clip_range: 0.2
  num_ppo_epochs: 1
  gradient_accumulation_steps: 1
  grad_norm_clip: 1.0

# --- è®­ç»ƒé…ç½® (ä¸¥æ ¼åŸç‰ˆé€»è¾‘) ---  
training:
  # ğŸ”¥ æ€»è®­ç»ƒæ­¥æ•° (ä¸æ˜¯epochï¼Œè€Œæ˜¯steps)
  num_train_steps: 10   # è°ƒè¯•ç”¨å°æ•°å€¼ï¼Œå®é™…å¯ä»¥è®¾ç½®æ›´å¤§
  
  # éšæœºç§å­
  seed: 42
  
  # ä¿å­˜é¢‘ç‡
  save_freq: 5
  save_best: true
  
  # ä¼˜åŒ–å™¨é…ç½®
  optimizer:
    type: "Adam"
    lr: 1e-5
    weight_decay: 0.0
    beta1: 0.9
    beta2: 0.999

# --- åˆ†å¸ƒå¼é…ç½® ---
distributed:
  backend: "nccl"
  gradient_checkpointing: false
  zero_optimization: false
  fp16: false
  bf16: false

# --- æ—¥å¿—é…ç½® ---
logging:
  use_wandb: false  # ç®€åŒ–ç‰ˆæœ¬å…³é—­wandb
  log_freq: 1
  log_gradients: false

# --- åŸç‰ˆç‰¹æœ‰é…ç½® ---
rollout:
  enabled: false  # è¯„ä¼°rolloutï¼Œè®­ç»ƒæœŸé—´å…³é—­
  interval: 1

# --- æ•°æ®é›†é…ç½® (åŸç‰ˆé€»è¾‘) ---
train_dataloader:
  batch_size: 4  # æ€»æ‰¹æ¬¡å¤§å°ï¼Œä¼šè¢«world_sizeåˆ†å‰²
  num_workers: 0
  pin_memory: true
  drop_last: false

# --- ç¯å¢ƒé…ç½® ---
env:
  use_libero: true
  benchmark_name: "libero_spatial"